!function(){"use strict";function e(e,t){return Math.floor(Math.random()*(t-e+1))+e}function t(t,s){const o=[];for(let n=0;n<t.diceCount;n++)o.push(e(1,t.diceFaces));let r=o.reduce((e,t)=>e+t,0);return"+"===t.modifierSign?r+=t.modifierValue:"-"===t.modifierSign&&(r-=t.modifierValue),{trialNumber:s,diceValues:o,total:r}}self.addEventListener("message",async e=>{const{type:s,config:o,trialCount:r,chunkSize:n}=e.data;if("simulate"===s)try{const e=await async function(e,s,o=1e3){const r=[];let n=0;for(let i=0;i<s;i+=o){const a=Math.min(o,s-i);for(let s=0;s<a;s++){const o=i+s+1;r.push(t(e,o))}n+=a;const c=n/s*100;self.postMessage({type:"progress",progress:c,processed:n,total:s}),n<s&&await new Promise(e=>setTimeout(e,0))}return r}(o,r,n);self.postMessage({type:"complete",results:e})}catch(i){self.postMessage({type:"error",error:i instanceof Error?i.message:"Unknown error"})}})}();
