import{a as e,j as a}from"./chart-js-B92AkZbw.js";import{u as t,M as s,a as r,b as n,I as d,s as i,f as l,e as o}from"./index-CB4xLEne.js";import"./vendor-CcyvE6mB.js";const g=[{code:"ja",label:"日本語",badge:"JA"},{code:"en",label:"English",badge:"EN"}],c=({isOpen:c,onClose:m,darkMode:x,onChangeDarkMode:h,onExportData:b,onImportData:y,diceSetsCount:p,chartSettingsCount:u,onAboutClick:k})=>{const{t:j,i18n:f}=t(["settings","common"]),[w,N]=e.useState(!1),[v,C]=e.useState(!1),M=e.useRef(null);return a.jsxs(s,{isOpen:c,onClose:m,size:"lg",children:[a.jsx(r,{title:j("settings:title"),onClose:m,closeButtonLabel:j("settings:close")}),a.jsxs(n,{scrollable:!0,children:[a.jsxs("section",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("div",{className:"w-1 h-6 bg-gray-400 dark:bg-gray-500 rounded-full"}),a.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:j("settings:appearance.title")})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[a.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-2",children:j("settings:appearance.theme.title")}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:j("settings:appearance.theme.description")}),a.jsxs("div",{className:"inline-flex rounded-lg bg-gray-200 dark:bg-gray-800 p-1 w-full",children:[a.jsxs("button",{onClick:()=>h("light"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-md font-medium transition-all "+("light"===x?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[a.jsx(d,{name:"sun",className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:j("settings:appearance.theme.light")})]}),a.jsxs("button",{onClick:()=>h("dark"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-md font-medium transition-all "+("dark"===x?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[a.jsx(d,{name:"moon",className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:j("settings:appearance.theme.dark")})]}),a.jsxs("button",{onClick:()=>h("system"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-md font-medium transition-all "+("system"===x?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[a.jsx(d,{name:"settings",className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:j("settings:appearance.theme.system")})]})]})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg border border-gray-200 dark:border-gray-700 mt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-2",children:j("settings:appearance.language.title")}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:j("settings:appearance.language.description")}),a.jsx("div",{className:"inline-flex rounded-lg bg-gray-200 dark:bg-gray-800 p-1 w-full",children:g.map(e=>a.jsxs("button",{onClick:()=>{f.language!==e.code&&(f.changeLanguage(e.code),i(e.code))},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-md font-medium transition-all "+(f.language===e.code?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[a.jsx("span",{className:"font-bold text-xs px-1.5 py-0.5 rounded bg-gray-300 dark:bg-gray-600",children:e.badge}),a.jsx("span",{children:e.label})]},e.code))})]})]}),a.jsxs("section",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("div",{className:"w-1 h-6 bg-gray-400 dark:bg-gray-500 rounded-full"}),a.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:j("settings:dataManagement.title")})]}),a.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 mb-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(d,{name:"info",className:"w-5 h-5 text-gray-600 dark:text-gray-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[a.jsx("p",{className:"font-medium mb-1",children:j("settings:dataManagement.currentData.title")}),a.jsx("p",{children:j("settings:dataManagement.currentData.diceSets").replace("{{count}}",l(p))}),a.jsx("p",{children:j("settings:dataManagement.currentData.chartSettings").replace("{{count}}",l(u))})]})]})}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg border border-gray-200 dark:border-gray-700 mb-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-2",children:j("settings:dataManagement.backup.title")}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:j("settings:dataManagement.backup.description")}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("button",{onClick:b,disabled:0===p,className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-800 dark:bg-gray-600 dark:hover:bg-gray-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsx(d,{name:"download",className:"w-4 h-4"}),j("settings:dataManagement.backup.export")]}),a.jsxs("button",{onClick:()=>{M.current?.click()},className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-800 dark:bg-gray-600 dark:hover:bg-gray-700 text-white font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[a.jsx(d,{name:"upload",className:"w-4 h-4"}),j("settings:dataManagement.backup.import")]}),a.jsx("input",{ref:M,type:"file",accept:".json",onChange:e=>{const a=e.target.files?.[0];a&&(y(a),M.current&&(M.current.value=""))},className:"hidden"})]})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[a.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-2",children:j("settings:dataManagement.reset.title")}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:j("settings:dataManagement.reset.description")}),w?a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm font-semibold text-red-600 dark:text-red-400",children:j("settings:dataManagement.reset.confirm")}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:async()=>{C(!0);try{if(await o(),await new Promise((e,a)=>{const t=indexedDB.deleteDatabase("DiceSimulatorDB");t.onsuccess=()=>{e()},t.onerror=()=>{a(new Error(j("settings:system.resetError")))},t.onblocked=()=>{setTimeout(()=>e(),1e3)}}),localStorage.clear(),"caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}window.location.reload()}catch(e){setTimeout(()=>{window.location.reload()},500)}},className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:v,children:v?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(d,{name:"spinner",className:"w-4 h-4 animate-spin"}),j("settings:dataManagement.reset.processing")]}):j("settings:dataManagement.reset.confirmButton")}),a.jsx("button",{onClick:()=>N(!1),className:"flex-1 px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-medium rounded-lg transition-colors",disabled:v,children:j("settings:dataManagement.reset.cancel")})]})]}):a.jsx("button",{onClick:()=>N(!0),className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:v,children:j("settings:dataManagement.reset.button")})]})]}),k&&a.jsx("section",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:a.jsxs("button",{onClick:()=>{k(),m()},className:"w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors flex items-center justify-between group",children:[a.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-300",children:j("about:sections.app.title")}),a.jsx(d,{name:"chevron-right",className:"w-5 h-5 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors"})]})})]})]})};export{c as SettingsModal};
